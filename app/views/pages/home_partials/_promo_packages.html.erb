<section class="promo-packages-home-section relative w-full px-0 max-sm:mt-[8rem] mt-[12rem] max-sm:mb-[6rem] row-span-1 col-span-full col-start-1">
  <div class="relative <%= "#{div_widths} #{gaps_for_indexes}" %> my-0 mx-auto grid grid-cols-[repeat(auto-fit,minmax(290px,1fr))] justify-center max-sm:px-4 px-3 max-sm:gap-8 gap-6">
    <div class="promo-home-card promo-title-card">
      <div class="promo-home-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          <text x="12" y="17" text-anchor="middle" font-size="18" font-weight="bold" fill="white">%</text>
        </svg>
      </div>
      <div class="promo-home-content promo-title-content">
        <h2 class="promo-home-title">Pachete promoționale</h2>
      </div>
    </div>
    
    <% @promo_packages.each_with_index do |promo_package, index| %>
      <div class="promo-home-card" style="animation-delay: <%= index * 0.15 %>s;" data-bs-toggle="modal" data-bs-target="#promoPhotoModal<%= promo_package.id %>">
        <% if promo_package.photo.attached? %>
          <div class="promo-home-photo">
            <%= cl_image_tag(promo_package.photo.key, quality: 85, width: 600, crop: "fill", gravity: "auto") %>
            <div class="promo-overlay">
              <% if promo_package.active? %>
                <span class="promo-badge active">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M6 3.75A2.75 2.75 0 018.75 1h2.5A2.75 2.75 0 0114 3.75v.443c.572.055 1.14.122 1.706.2C17.053 4.582 18 5.75 18 7.07V19a2 2 0 01-2 2H4a2 2 0 01-2-2V7.07c0-1.32.947-2.488 2.294-2.676A41.047 41.047 0 016 4.193V3.75zm6.5 0v.325a41.622 41.622 0 00-5 0V3.75c0-.69.56-1.25 1.25-1.25h2.5c.69 0 1.25.56 1.25 1.25zM10 10a1 1 0 00-1 1v.01a1 1 0 001 1h.01a1 1 0 001-1V11a1 1 0 00-1-1H10z" clip-rule="evenodd" />
                  </svg>
                  Activ
                </span>
              <% else %>
                <span class="promo-badge expired">Expirat</span>
              <% end %>
            </div>
          </div>
        <% else %>
          <div class="promo-home-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M5.166 2.621v.858c-1.035.148-2.059.33-3.071.543a.75.75 0 00-.584.859 6.753 6.753 0 006.138 5.6 6.73 6.73 0 002.743 1.346A6.707 6.707 0 019.279 15H8.54c-1.036 0-1.875.84-1.875 1.875V19.5h-.75a2.25 2.25 0 00-2.25 2.25c0 .414.336.75.75.75h15a.75.75 0 00.75-.75 2.25 2.25 0 00-2.25-2.25h-.75v-2.625c0-1.036-.84-1.875-1.875-1.875h-.739a6.706 6.706 0 01-1.112-3.173 6.73 6.73 0 002.743-1.347 6.753 6.753 0 006.139-5.6.75.75 0 00-.585-.858 47.077 47.077 0 00-3.07-.543V2.62a.75.75 0 00-.658-.744 49.22 49.22 0 00-6.093-.377c-2.063 0-4.096.128-6.093.377a.75.75 0 00-.657.744zm0 2.629c0 1.196.312 2.32.857 3.294A5.266 5.266 0 013.16 5.337a45.6 45.6 0 012.006-.343v.256zm13.5 0v-.256c.674.1 1.343.214 2.006.343a5.265 5.265 0 01-2.863 3.207 6.72 6.72 0 00.857-3.294z" clip-rule="evenodd" />
            </svg>
          </div>
        <% end %>
        
        <div class="promo-home-content">
          <h3 class="promo-home-title"><%= promo_package.name %></h3>
          <% if promo_package.sub_name.present? %>
            <p class="promo-home-subtitle"><%= promo_package.sub_name %></p>
          <% end %>
          
          <% if promo_package.initial_price.present? || promo_package.discounted_price.present? %>
            <div class="promo-home-pricing">
              <% if promo_package.initial_price.present? && promo_package.discounted_price.present? %>
                <span class="home-price-original"><%= number_to_currency(promo_package.initial_price, unit: 'RON', separator: ',', delimiter: '.', format: '%n %u') %></span>
                <span class="home-price-discounted"><%= number_to_currency(promo_package.discounted_price, unit: 'RON', separator: ',', delimiter: '.', format: '%n %u') %></span>
              <% elsif promo_package.discounted_price.present? %>
                <span class="home-price-discounted"><%= number_to_currency(promo_package.discounted_price, unit: 'RON', separator: ',', delimiter: '.', format: '%n %u') %></span>
              <% elsif promo_package.initial_price.present? %>
                <span class="home-price-discounted"><%= number_to_currency(promo_package.initial_price, unit: 'RON', separator: ',', delimiter: '.', format: '%n %u') %></span>
              <% end %>
            </div>
          <% end %>

          <% if promo_package.benefits.present? %>
            <div class="promo-home-benefits">
              <%= promo_package.benefits %>
            </div>
          <% end %>

          <div class="promo-home-date">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h10.5c.69 0 1.25-.56 1.25-1.25v-6.5c0-.69-.56-1.25-1.25-1.25H4.75z" clip-rule="evenodd" />
            </svg>
            <span>Până la <%= promo_package.valid_until.strftime('%d.%m.%Y') %></span>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  
  <div class="text-center mt-12">
    <%= link_to promotii_path, class: 'inline-block text-xl font-semibold text-gray-700 hover:text-orange-600 transition-colors font-poppins' do %>
      Vezi toate pachete →
    <% end %>
  </div>
</section>

<!-- Promo Photo Modals -->
<% @promo_packages.each do |promo_package| %>
  <% if promo_package.photo.attached? %>
    <div class="modal fade" id="promoPhotoModal<%= promo_package.id %>" tabindex="-1" aria-labelledby="promoPhotoModalLabel<%= promo_package.id %>" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg" style="max-height: 80vh;">
        <div class="modal-content" style="background: transparent; border: none; height: 80vh;">
          <div class="modal-header" style="border: none; padding: 0; position: absolute; top: -50px; right: 0; z-index: 1051;">
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));"></button>
          </div>
          <div class="modal-body" style="padding: 0; height: 100%; display: flex; align-items: center; justify-content: center;">
            <%= cl_image_tag(promo_package.photo.key, quality: 95, width: 1200, crop: "limit", class: "rounded-3", style: "max-height: 100%; max-width: 100%; object-fit: contain;") %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
<% end %>

<style>

  .promo-home-card {
    background: white;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    width: 100%;
    min-width: 290px;
    max-width: 300px;
    justify-self: center;
    display: flex;
    flex-direction: column;
    min-height: 600px;
  }


  .promo-home-card:hover {
    transform: translateY(-12px) scale(1.03);
    box-shadow: 0 20px 40px rgba(249, 115, 22, 0.25);
  }

  .promo-title-card {
    cursor: default;
  }

  .promo-title-card:hover {
    transform: none;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .promo-title-card .promo-home-icon {
    background: #4A6775;
    font-size: 120px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 360px;
    flex-shrink: 0;
  }

  .promo-title-card .promo-home-icon::after {
    content: "%";
    font-size: 120px;
    color: white;
  }

  .promo-title-card .promo-home-icon svg {
    display: none;
  }

  .promo-title-content {
    display: flex;
    justify-content: center;
    align-items: center;
    flex: 1;
    padding: 1.5rem;
  }

  .promo-title-card .promo-home-title {
    font-size: 1.5rem;
    margin: 0;
    text-align: center;
  }

  @media (min-width: 768px) {
    .promo-title-card .promo-home-title {
      font-size: 1.75rem;
    }
  }

  .promo-home-photo {
    width: 100%;
    overflow: hidden;
    position: relative;
    height: 360px;
    flex-shrink: 0;
  }

  .promo-home-photo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform 0.5s ease;
  }

  .promo-home-card:hover .promo-home-photo img {
    transform: scale(1.15) rotate(2deg);
  }

  .promo-overlay {
    position: absolute;
    top: 1rem;
    right: 1rem;
    z-index: 1;
  }

  .promo-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    backdrop-filter: blur(10px);
  }

  .promo-badge.active {
    background: rgba(220, 252, 231, 0.95);
    color: #15803d;
    box-shadow: 0 2px 8px rgba(21, 128, 61, 0.3);
  }

  .promo-badge svg {
    width: 14px;
    height: 14px;
  }

  .promo-badge.expired {
    background: rgba(254, 226, 226, 0.95);
    color: #b91c1c;
    box-shadow: 0 2px 8px rgba(185, 28, 28, 0.3);
  }

  .promo-home-icon {
    width: 100%;
    height: 200px;
    flex-shrink: 0;
    background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .promo-home-icon svg {
    width: 100px;
    height: 100px;
    color: white;
    opacity: 0.9;
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
  }

  .promo-home-content {
    padding: .8rem;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .promo-home-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: #1f2937;
    margin: 0 0 0.5rem 0;
    line-height: 1.3;
  }

  .promo-home-subtitle {
    font-size: 0.875rem;
    color: #6b7280;
    margin: 0 0 0.75rem 0;
    line-height: 1.3;
  }

  .promo-home-pricing {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
  }

  .home-price-original {
    font-size: 0.9rem;
    color: #9ca3af;
    text-decoration: line-through;
    line-height: 1.3;
  }

  .home-price-discounted {
    font-size: 1.306rem;
    font-weight: 800;
    background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.2;
  }

  .promo-home-benefits {
    margin-bottom: 0.5rem;
    padding: 0.75rem;
    background: #f9fafb;
    border-radius: 8px;
    border-left: 3px solid #f97316;
    font-size: 0.83rem;
    color: #4b5563;
    line-height: 1.5;
  }

  .promo-home-benefits ul {
    margin: 0;
    padding-left: 1.25rem;
  }

  .promo-home-benefits li {
    margin-bottom: 0.25rem;
  }

  .promo-home-benefits p {
    margin: 0;
  }

  .promo-home-benefits ul {
    margin: 0;
    padding-left: 1.25rem;
  }

  .promo-home-benefits li {
    margin-bottom: 0.15rem;
  }

  .promo-home-date {
    display: flex;
    align-items: center;
    gap: 0.625rem;
    font-size: 0.89rem;
    color: #6b7280;
    line-height: 1.3;
    padding-bottom: 0.5rem;
    margin-top: auto;
  }

  .promo-home-date svg {
    width: 20px;
    height: 20px;
    color: #f97316;
  }

  @media (max-width: 768px) {
    .promo-packages-home-section {
      padding: 2rem 0;
    }

    .promo-header .header-content h2 {
      font-size: 2rem;
    }

    .promo-packages-home-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .promo-home-card {
      margin-bottom: 1rem;
    }

    .promo-home-photo {
      height: 360px;
    }

    .promo-home-icon {
      height: 220px;
    }
  }
</style>
