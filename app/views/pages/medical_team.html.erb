<%= content_for :meta_title, 'Echipa medicală Spinal Care Bacău' %>
<%= content_for :meta_keywords, @team_members.map{|tm| full_name_with_title(tm)}.join(', ') %>

<div class="modern-team-page">
  <!-- Hero Section -->
  <div class="team-hero">
    <div class="team-hero-content">
      <h1>Echipa Medicală</h1>
      <p>Profesioniști dedicați sănătății dumneavoastră</p>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="team-filters" data-controller="memberIndexFilter">
    <div class="filters-container">
      <input 
        type="text" 
        placeholder="Caută după nume..." 
        class="filter-search-input"
        data-memberindexfilter-target="nameInput"
        data-action="input->memberIndexFilter#filterByName"
      >
      
      <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all" data-action="click->memberIndexFilter#filterByProfession">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 9a3 3 0 100-6 3 3 0 000 6zM6 8a2 2 0 11-4 0 2 2 0 014 0zM1.49 15.326a.78.78 0 01-.358-.442 3 3 0 014.308-3.516 6.484 6.484 0 00-1.905 3.959c-.023.222-.014.442.025.654a4.97 4.97 0 01-2.07-.655zM16.44 15.98a4.97 4.97 0 002.07-.654.78.78 0 00.357-.442 3 3 0 00-4.308-3.517 6.484 6.484 0 011.907 3.96 2.32 2.32 0 01-.026.654zM18 8a2 2 0 11-4 0 2 2 0 014 0zM5.304 16.19a.844.844 0 01-.277-.71 5 5 0 019.947 0 .843.843 0 01-.277.71A6.975 6.975 0 0110 18a6.974 6.974 0 01-4.696-1.81z" />
          </svg>
          Toată echipa
        </button>
        
        <% @professions.select{|p| p.members.where(is_active: true).count > 0}.each do |profession| %>
          <button class="filter-btn" data-filter="<%= profession.slug %>" data-action="click->memberIndexFilter#filterByProfession">
            <%= profession.name %>
          </button>
        <% end %>
      </div>

      <div class="filter-specialties">
        <label class="filter-label">Filtrează după specialitate:</label>
        <select class="filter-select" data-action="change->memberIndexFilter#filterBySpecialty">
          <option value="all">Toate specialitățile</option>
          <% @specialties.select{|s| s.members.where(is_active: true).count > 0}.each do |specialty| %>
            <option value="<%= specialty.slug %>"><%= specialty.name %></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>

  <!-- Founder Section -->
  <% if @founder %>
    <div class="founder-section">
      <div class="section-header">
        <h2>Fondator</h2>
        <div class="section-line"></div>
      </div>
      <div class="founder-card-container">
        <%= render partial: "members/modern_member_card", locals: {m: @founder} %>
      </div>
    </div>
  <% end %>

  <!-- Team Members by Profession -->
  <% @professions.each do |profession| %>
    <% active_members = profession.members.where(is_active: true).where.not(founder: true).order(:last_name) %>
    <% if active_members.any? %>
      <div class="profession-section" data-profession="<%= profession.slug %>" data-memberindexfilter-target="professionSection">
        <div class="section-header">
          <h2><%= profession.name.pluralize(active_members.count) %></h2>
          <span class="member-count"><%= active_members.count %> <%= active_members.count == 1 ? 'membru' : 'membri' %></span>
          <div class="section-line"></div>
        </div>
        
        <div class="team-grid">
          <% active_members.each do |member| %>
            <%= render partial: "members/modern_member_card", locals: {m: member} %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>