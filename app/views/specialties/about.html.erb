<%= content_for :meta_title, "#{@specialty.name} Spinal Care Bacau" %>
<%= content_for :meta_description, description_gsub(@specialty)[0, 150] %>

<div class="modern-specialty-page">
  <!-- Hero Section -->
  <div class="specialty-hero">
    <div class="specialty-hero-content">
      <h1><%= @specialty.name %></h1>
      <div class="specialty-dropdown">
        <div class="btn-group dropdown-center">
          <button type="button" class="specialty-dropdown-btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            Alte specialități medicale
          </button>
          <ul class="dropdown-menu">
            <% @all_specialties.each do |spec| %>
              <li><%= link_to spec.name, "#{spec.slug}", class: 'dropdown-item' %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Specialty Description -->
  <div class="specialty-content">
    <div class="specialty-description">
      <%= @specialty.description %>
    </div>

    <!-- Day Hospitalization Specialties Section -->
    <% if @specialty.is_day_hospitalize %>
      <div class="specialty-section">
        <div class="section-header">
          <h2>Specialități medicale cu spitalizare de zi</h2>
          <div class="section-line"></div>
        </div>
        <div class="specialties-grid">
          <% @all_specialties.select { |s| s.has_day_hospitalization}.each do |s| %>
            <%= render partial: 'specialties/modern_specialty_card', locals: {specialty: s} %> 
          <% end %>
        </div>
      </div>

      <!-- Day Hospitalization Specialists Section -->
      <% if @specialists.count > 0 %>
        <div class="specialty-section">
          <div class="section-header">
            <h2>Medici care consultă în regim de spitalizare de zi</h2>
            <div class="section-line"></div>
          </div>
          <div class="team-grid">
            <% @specialists.each do |s| %>
              <%= render partial: "members/modern_member_card", locals: {m: s} %>
            <% end %>
          </div>
        </div>
      <% end %>
    <% end %>

    <!-- Specialists Section -->
    <div class="specialty-section">
      <%= action_btn("Programează-te!", "btn-custom", "btn-action !bg-orange-600") %>
      <div class="section-header">
        <h2>Specialiști <%= @specialty.name.downcase %></h2>
        <div class="section-line"></div>
      </div>
      <div class="team-grid">
        <% @specialty.members_belonging_to_specialty.concat(specialty_specialists(@specialty)).uniq
        .sort_by { |a| a.specialty_favored ? 0:1 }
        .each_with_index do |member| %>
          <%= render partial: 'members/modern_member_card', locals: {m: member} %>
        <% end %>
      </div>
    </div>

    <!-- Medical Services Section -->
    <% if @specialty.medical_services.any? %>
      <div class="specialty-section">
        <div class="section-header">
          <h2>Servicii Medicale <%= @specialty.name %></h2>
          <div class="section-line"></div>
        </div>
        <div class="services-grid-modern">
          <% @specialty.medical_services.sort_by(&:name).each do |service| %>
            <%= render partial: 'medical_services/service_card_public', locals: { medical_service: service } %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
